angular.module("siyfion.sfTypeahead",[]).directive("sfTypeahead",function(){return{restrict:"AC",require:"?ngModel",scope:{options:"=",datasets:"="},link:function(a,b,c,d){function e(a){var b=0;if(a=a[0],document.selection){var c=document.selection.createRange();c.moveStart("character",-a.value.length),b=c.text.length}else"number"==typeof a.selectionStart&&(b=a.selectionStart);return b}function f(a,b){if(a=a[0],document.selection){var c=a.createTextRange();c.move("character",b),c.select()}else"number"==typeof a.selectionStart&&(a.focus(),a.setSelectionRange(b,b))}function g(c,e){var f=b.val();a.$apply(function(){h=!1,d.$setViewValue(e)}),b.val(f)}var h=!1;b.typeahead(a.options,a.datasets),d.$parsers.push(function(b){return a.options.editable===!1&&(d.$setValidity("typeahead",!h),h)?void 0:b}),b.bind("typeahead:selected",function(b,c,d){g(b,c,d),a.$emit("typeahead:selected")}),b.bind("typeahead:autocompleted",function(b,c,d){g(b,c,d),a.$emit("typeahead:autocompleted")}),b.bind("typeahead:opened",function(){a.$emit("typeahead:opened")}),b.bind("typeahead:closed",function(){a.$emit("typeahead:closed")}),b.bind("typeahead:cursorchanged",function(b,c,d){a.$emit("typeahead:cursorchanged",b,c,d)}),b.bind("input",function(){var c=e(b);a.$apply(function(){var a=b.val();h=!0,d.$setViewValue(a)}),f(b,c)})}}});